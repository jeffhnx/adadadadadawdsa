-- ESP Script for Roblox (Highlight players with team color distinction)

local ESP = {}
local players = game:GetService("Players")
local runService = game:GetService("RunService")

-- Customize the ESP colors
ESP.TeamColor = Color3.new(0, 1, 0)  -- Green for teammates
ESP.EnemyColor = Color3.new(1, 0, 0) -- Red for enemies

-- Function to create ESP for a player
function CreateESP(player)
    local highlight = Instance.new("Highlight")
    highlight.Parent = player.Character
    highlight.Adornee = player.Character
    highlight.FillTransparency = 0.5
    highlight.OutlineTransparency = 0.5

    -- Team check
    if player.Team == players.LocalPlayer.Team then
        highlight.FillColor = ESP.TeamColor
    else
        highlight.FillColor = ESP.EnemyColor
    end
end

-- Function to remove ESP when player dies or leaves
function RemoveESP(player)
    if player.Character then
        for _, v in pairs(player.Character:GetChildren()) do
            if v:IsA("Highlight") then
                v:Destroy()
            end
        end
    end
end

-- Apply ESP to existing players
for _, player in pairs(players:GetPlayers()) do
    if player ~= players.LocalPlayer and player.Character then
        CreateESP(player)
        -- Remove ESP when player dies
        player.CharacterRemoving:Connect(function()
            RemoveESP(player)
        end)
    end
end

-- Apply ESP to newly joining players
players.PlayerAdded:Connect(function(player)
    player.CharacterAdded:Connect(function()
        CreateESP(player)
    end)
end)

-- Update ESP during runtime
runService.RenderStepped:Connect(function()
    for _, player in pairs(players:GetPlayers()) do
        if player ~= players.LocalPlayer and player.Character then
            CreateESP(player)
        end
    end
end)
